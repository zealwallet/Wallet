/******/(()=>{// webpackBootstrap
/******/"use strict";
/******/var e={
/***/686:
/***/(e,t)=>{t.d=void 0,t.d=e=>{let t=()=>{},r=()=>{};const n=new Promise(((e,n)=>{t=e,r=n}));return{id:e,resolve:t,reject:r,promise:n}}}
/***/,
/***/847:
/***/(e,t,r)=>{t.W=void 0;const n=r(970),o=e=>Array.isArray(e),i=()=>new Error("Aborted by signal"),s=()=>new Error("Aborted by deadline"),a=()=>new Error("Aborted by timeout"),c=(e,t)=>new Promise(((r,n)=>{if(t.aborted)return n();if(void 0===e)return r();const o=setTimeout(r,e),i=()=>{clearTimeout(o),t.removeEventListener("abort",i),n()};t.addEventListener("abort",i)})),u=(e,t,r)=>new Promise(((n,o)=>{if(r.aborted)return o();const i=void 0!==e?setTimeout((()=>o(t())),e):void 0,s=()=>{clearTimeout(i),r.removeEventListener("abort",s),o()};r.addEventListener("abort",s)})),l=(e,t)=>new Promise(((r,n)=>{if(t.aborted)return n();if(null==e?void 0:e.aborted)return n(i());const o=()=>n(i());null==e||e.addEventListener("abort",o);const s=()=>{null==e||e.removeEventListener("abort",o),t.removeEventListener("abort",s),n()};t.addEventListener("abort",s)})),f=(e,t)=>n.__awaiter(void 0,void 0,void 0,(function*(){const r=new AbortController,n=()=>r.abort();t.aborted&&n(),t.addEventListener("abort",n);try{return yield new Promise((t=>t(e(r.signal))))}finally{t.removeEventListener("abort",n)}}));t.W=(e,t)=>n.__awaiter(void 0,void 0,void 0,(function*(){const{signal:r,delay:i,attempts:h,timeout:d,deadline:p,gap:v}=t,y=p&&p-Date.now(),m=o(h)?h.length:null!=h?h:p?1/0:1,_=new AbortController,b=_.signal,w=o(h)?e=>h[e]:()=>({timeout:d,gap:v});try{return yield Promise.race([l(r,b),u(y,s,b),c(i,b).then((()=>((e,t,r,o)=>n.__awaiter(void 0,void 0,void 0,(function*(){for(let n=0;n<e-1&&!o.aborted;n++){const e=new AbortController,i=()=>e.abort();o.addEventListener("abort",i);try{return yield t(n,e.signal)}catch(e){i(),yield r(n)}finally{o.removeEventListener("abort",i)}}return o.aborted?Promise.reject():t(e-1,o)})))(m,((t,r)=>Promise.race([u(w(t).timeout,a,b),f(e,r)])),(e=>{var t;return c(null!==(t=w(e).gap)&&void 0!==t?t:0,b)}),b)))])}finally{_.abort()}}))
/***/},
/***/750:
/***/(e,t,r)=>{t.s=void 0;const n=r(699);class o extends n.EventEmitter{listenerCount(e){return super.listenerCount(e)}}t.s=o}
/***/,
/***/699:
/***/e=>{
// Copyright Joyent, Inc. and other Node contributors.
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function o(r){e.removeListener(t,i),n(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}v(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&v(e,"error",t,{once:!0})}(e,o)}))},
// Backwards-compat with node 0.10.x
i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;
// By default EventEmitters will print a warning if more than 10 listeners are
// added to it. This is a useful default which helps finding memory leaks.
var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var o,i,s,u;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(
// To avoid recursion in the case that type === "newListener"! Before
// adding it to the listeners, first emit "newListener".
void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),
// Re-assign `events` because a newListener handler could have caused the
// this._events to be assigned to a new object
i=e._events),s=i[t]),void 0===s)
// Optimize the case of one listener. Don't need the extra array object.
s=i[t]=r,++e._eventsCount;else if("function"==typeof s?
// Adding the second element, need to change to array.
s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),
// Check for listener leak
(o=c(e))>0&&s.length>o&&!s.warned){s.warned=!0;
// No error code for this since it is a Warning
// eslint-disable-next-line no-restricted-syntax
var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=l.bind(n);return o.listener=r,n.wrapFn=o,o}function h(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):p(o,o.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function v(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);
// EventTarget does not have `error` event semantics like Node
// EventEmitters, we do not listen for `error` events here.
e.addEventListener(t,(function o(i){
// IE does not have builtin `{ once: true }` support so we
// have to do it manually.
n.once&&e.removeEventListener(t,o),r(i)}))}}
/***/Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},
// Obviously not all Emitters should be limited to 10. This function allows
// that to be increased. Set to zero for unlimited.
i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;
// If there is no 'error' event listener then throw.
if(o){var s;if(t.length>0&&(s=t[0]),s instanceof Error)
// Note: The comments on the `throw` lines are intentional, they show
// up in Node's output if this results in an unhandled exception.
throw s;// Unhandled 'error' event
// At least give some kind of context to the user
var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a;// Unhandled 'error' event
}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var u=c.length,l=p(c,u);for(r=0;r<u;++r)n(l[r],this,t)}return!0},i.prototype.addListener=function(e,t){return u(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return u(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,f(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,f(this,e,t)),this},
// Emits a 'removeListener' event if and only if the listener was removed.
i.prototype.removeListener=function(e,t){var r,n,o,i,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;
// not listening for removeListener, no need to emit
if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;
// emit removeListener for all listeners on all events
if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)
// LIFO order
for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},i.prototype.listenerCount=d,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},
/***/970:
/***/(e,t,r)=>{r.r(t),
/* harmony export */r.d(t,{
/* harmony export */__addDisposableResource:()=>/* binding */A
/* harmony export */,__assign:()=>/* binding */i
/* harmony export */,__asyncDelegator:()=>/* binding */j
/* harmony export */,__asyncGenerator:()=>/* binding */E
/* harmony export */,__asyncValues:()=>/* binding */L
/* harmony export */,__await:()=>/* binding */O
/* harmony export */,__awaiter:()=>/* binding */p
/* harmony export */,__classPrivateFieldGet:()=>/* binding */F
/* harmony export */,__classPrivateFieldIn:()=>/* binding */C
/* harmony export */,__classPrivateFieldSet:()=>/* binding */M
/* harmony export */,__createBinding:()=>/* binding */y
/* harmony export */,__decorate:()=>/* binding */a
/* harmony export */,__disposeResources:()=>/* binding */I
/* harmony export */,__esDecorate:()=>/* binding */u
/* harmony export */,__exportStar:()=>/* binding */m
/* harmony export */,__extends:()=>/* binding */o
/* harmony export */,__generator:()=>/* binding */v
/* harmony export */,__importDefault:()=>/* binding */T
/* harmony export */,__importStar:()=>/* binding */k
/* harmony export */,__makeTemplateObject:()=>/* binding */x
/* harmony export */,__metadata:()=>/* binding */d
/* harmony export */,__param:()=>/* binding */c
/* harmony export */,__propKey:()=>/* binding */f
/* harmony export */,__read:()=>/* binding */b
/* harmony export */,__rest:()=>/* binding */s
/* harmony export */,__runInitializers:()=>/* binding */l
/* harmony export */,__setFunctionName:()=>/* binding */h
/* harmony export */,__spread:()=>/* binding */w
/* harmony export */,__spreadArray:()=>/* binding */P
/* harmony export */,__spreadArrays:()=>/* binding */g
/* harmony export */,__values:()=>/* binding */_
/* harmony export */,default:()=>D
/* harmony export */});
/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/* global Reflect, Promise, SuppressedError, Symbol */
var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function a(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,o,i){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=n.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,f=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),h=!1,d=r.length-1;d>=0;d--){var p={};for(var v in n)p[v]="access"===v?{}:n[v];for(var v in n.access)p.access[v]=n.access[v];p.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(e||null))};var y=(0,r[d])("accessor"===c?{get:f.get,set:f.set}:f[u],p);if("accessor"===c){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(a=s(y.get))&&(f.get=a),(a=s(y.set))&&(f.set=a),(a=s(y.init))&&o.unshift(a)}else(a=s(y))&&("field"===c?o.unshift(a):f[u]=a)}l&&Object.defineProperty(l,n.name,f),h=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function f(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var y=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function m(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||y(t,e,r)}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}
/** @deprecated */function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}
/** @deprecated */function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}function P(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function O(e){return this instanceof O?(this.v=e,this):new O(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=o[e](t)).value instanceof O?Promise.resolve(r.value.v).then(c,u):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function j(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:O(e[n](t)),done:!1}:o?o(t):t}:o}}function L(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=_(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var S=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&y(t,e,r);return S(t,e),t}function T(e){return e&&e.__esModule?e:{default:e}}function F(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function M(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function C(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function A(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var R="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function I(e){function t(t){e.error=e.hasError?new R(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}
/* harmony default export */const D={__extends:o,__assign:i,__rest:s,__decorate:a,__param:c,__metadata:d,__awaiter:p,__generator:v,__createBinding:y,__exportStar:m,__values:_,__read:b,__spread:w,__spreadArrays:g,__spreadArray:P,__await:O,__asyncGenerator:E,__asyncDelegator:j,__asyncValues:L,__makeTemplateObject:x,__importStar:k,__importDefault:T,__classPrivateFieldGet:F,__classPrivateFieldSet:M,__classPrivateFieldIn:C,__addDisposableResource:A,__disposeResources:I};
/***/
/******/}},t={};
/************************************************************************/
/******/ // The module cache
/******/
/******/
/******/ // The require function
/******/function r(n){
/******/ // Check if module is in cache
/******/var o=t[n];
/******/if(void 0!==o)
/******/return o.exports;
/******/
/******/ // Create a new module (and put it into the cache)
/******/var i=t[n]={
/******/ // no module.id needed
/******/ // no module.loaded needed
/******/exports:{}
/******/};
/******/
/******/ // Execute the module function
/******/
/******/
/******/ // Return the exports of the module
/******/return e[n](i,i.exports,r),i.exports;
/******/}
/******/
/************************************************************************/
/******/ /* webpack/runtime/define property getters */
/******/
/******/ // define getter functions for harmony exports
/******/r.d=(e,t)=>{
/******/for(var n in t)
/******/r.o(t,n)&&!r.o(e,n)&&
/******/Object.defineProperty(e,n,{enumerable:!0,get:t[n]})
/******/;
/******/},
/******/r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)
/******/
/******/ // define __esModule on exports
/******/,r.r=e=>{
/******/"undefined"!=typeof Symbol&&Symbol.toStringTag&&
/******/Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})
/******/,Object.defineProperty(e,"__esModule",{value:!0})}
/******/,
// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.
(()=>{
// EXTERNAL MODULE: ../utils/lib/createDeferred.js
var e=r(686),t=r(750),n=r(847);
// EXTERNAL MODULE: ../utils/lib/typedEventEmitter.js
// CONCATENATED MODULE: ../connect-common/src/messageChannel/abstract.ts
/**
 * IMPORTS WARNING
 * this file is bundled into content script so be careful what you are importing not to bloat the bundle
 */
// todo: I can't import Log from connect to connect-common (connect imports from connect-common).
// so logger should be probably moved to connect common, or this file should be moved to connect
// import type { Log } from '@trezor/connect/lib/utils/debug';
/**
 * concepts:
 * - it handshakes automatically with the other side of the channel
 * - it queues messages fired before handshake and sends them after handshake is done
 */class o extends t/* TypedEmitter */.s{messagePromises={};
/** queue of messages that were scheduled before handshake */
messagesQueue=[];messageID=0;handshakeMaxRetries=5;handshakeRetryInterval=2e3;
/**
   * function that passes data to the other side of the channel
   */
/**
   * channel identifiers that pairs AbstractMessageChannel instances on sending and receiving end together
   */
constructor({sendFn:e,channel:t,logger:r}){super(),this.channel=t,this.sendFn=e,this.logger=r}
/**
   * initiates handshake sequence with peer. resolves after communication with peer is established
   */init(){return this.handshakeFinished||(this.handshakeFinished=(0,e/* createDeferred */.d)(),this.handshakeWithPeer()),this.handshakeFinished.promise}
/**
   * handshake between both parties of the channel.
   * both parties initiate handshake procedure and keep asking over time in a loop until they time out or receive confirmation from peer
   */handshakeWithPeer(){return this.logger?.log(this.channel.here,"handshake"),(0,n/* scheduleAction */.W)((async()=>{this.postMessage({type:"channel-handshake-request",data:{success:!0,payload:void 0}},{usePromise:!1,useQueue:!1}),await(this.handshakeFinished?.promise)}),{attempts:this.handshakeMaxRetries,timeout:this.handshakeRetryInterval}).then((()=>{this.logger?.log(this.channel.here,"handshake confirmed"),this.messagesQueue.forEach((e=>{e.channel=this.channel,this.sendFn(e)})),this.messagesQueue=[]})).catch((()=>{this.handshakeFinished?.reject(new Error("handshake failed")),this.handshakeFinished=void 0}))}
/**
   * message received from communication channel in descendants of this class
   * should be handled by this common onMessage method
   */onMessage(e){const{channel:t,id:r,type:n,payload:o,success:i}=e;if(!t?.peer||t.peer!==this.channel.here)return;if(!t?.here||this.channel.peer!==t.here)return;if("channel-handshake-request"===n)return void this.postMessage({type:"channel-handshake-confirm",data:{success:!0,payload:void 0}},{usePromise:!1,useQueue:!1});if("channel-handshake-confirm"===n)return void this.handshakeFinished?.resolve(void 0);this.messagePromises[r]&&(this.messagePromises[r].resolve({id:r,payload:o,success:i}),delete this.messagePromises[r]);const s=Object.keys(this.messagePromises).length;s>5&&this.logger.warn(`too many message promises (${s}). this feels unexpected!`),this.emit("message",e)}
// todo: outgoing messages should be typed
postMessage(t,{usePromise:r=!0,useQueue:n=!0}={}){if(t.channel=this.channel,r){this.messageID++,t.id=this.messageID,this.messagePromises[t.id]=(0,e/* createDeferred */.d)();try{this.sendFn(t)}catch(e){n&&this.messagesQueue.push(t)}return this.messagePromises[t.id].promise}try{this.sendFn(t)}catch(e){n&&this.messagesQueue.push(t)}}resolveMessagePromises(e){
// This is used when we know that the connection has been interrupted but there might be something waiting for it.
Object.keys(this.messagePromises).forEach((t=>this.messagePromises[t].resolve({id:t,payload:e})))}clear(){this.handshakeFinished=void 0}}// CONCATENATED MODULE: ./src/contentScript.ts
/**
 * communication between service worker and both webextension and popup manager
 */const i=new// CONCATENATED MODULE: ./src/channels/window-serviceworker.ts
/**
 * Communication channel between:
 * - here: chrome message port (in service worker)
 * - peer: window.onMessage in trezor-content-script
 */
class extends o{constructor({name:e,channel:t}){super({channel:t,sendFn:e=>{if(!this.port)throw new Error("port not assigned");this.port.postMessage(e)}});const r=chrome.runtime.connect({name:e});this.port=r,this.port.onMessage.addListener((e=>{e.channel.here!==this.channel.here&&this.onMessage(e)}))}disconnect(){this.port?.disconnect()}}({name:"trezor-connect",channel:{here:"@trezor/connect-content-script",peer:"@trezor/connect-webextension"}});i.init().then((()=>{
// once script is loaded. send information about the webextension that injected it into the popup
window.postMessage({type:"popup-content-script-loaded",payload:{...chrome.runtime.getManifest(),id:chrome.runtime.id}},window.location.origin),
/**
   * Passing messages from service worker to popup
   */
i.on("message",(e=>{window.postMessage(e,window.location.origin)})),
/*
   * Passing messages from popup to service worker
   */
window.addEventListener("message",(e=>{"@trezor/connect-webextension"!==e.data?.channel?.here&&"popup-content-script-loaded"!==e.data?.type&&e.source===window&&e.data&&i.postMessage(e.data,{usePromise:!1})})),window.addEventListener("beforeunload",(()=>{window.postMessage({type:"popup-closed"},window.location.origin)}))}))})()
/******/})();